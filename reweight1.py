import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import cross_val_score, KFold


# Read data from files
y, ybar = [], []
with open("weights/ybar.txt", 'r') as file:
    for line in file:
        ybar.append(eval(line.strip()))
with open("weights/y.txt", 'r') as file:
    for line in file:
        y.append(line.strip())

# Convert lists to numpy arrays
ybar = np.array(ybar).astype(np.int64)
y = np.array(y).astype(np.int64)

# Initialize Linear Regression model
model = LinearRegression()
cv_scores = cross_val_score(model, ybar, y,
                            cv=KFold(n_splits=10, shuffle=True),
                            scoring='neg_root_mean_squared_error')

# Print CV results
print(f"CV RMSE: {-cv_scores.mean()}")

# Fit model to the data
model.fit(ybar, y)

# Print weights (coefficients)
print("MODEL WEIGHTS: ", model.coef_)

# Normalize weights
weights = list(model.coef_)
SUM = sum(weights)
weights = [weight / SUM * len(weights) for weight in weights]
print(weights)